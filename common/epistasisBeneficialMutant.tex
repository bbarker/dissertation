\section{Introduction}

\subsection{Adaptive Mutations}

Biologists have long wondered the extent to which evolution occurs due
to nearly neutral and slighly deleterious mutations, or adaptive
mutations, or more complex situations involving these types of
mutations as well as their epistatic interactions (cite the work of
Kimura etc.).

The occurence of beneficial mutations and how they affect adaptation
is currently an area of active interest in evolutionary biology
\citep{Chou2011, Weinreich2006}. Although much focus in the past
has been placed on deleterious mutations because of their prevalence
in nature and disease, it is ultimately beneficial mutations that
are responsible for adaptive evolution.
 
\subsection{Adaptive Mutations and Epistasis}



\subsection{The Need for a New Modeling Framework}
Clearly, using FBA with the growth objective alone is not enough--we
only ever get the optimum for our fitness objective.  A way to
circumvent this issue is to associate a feature of the system
(e.g. flux into biomass) as the fitness while optimizing some other
objective. This latter mechanism is not generally used as most models
tend to be rather under-constrained as is. However, as we've seen, the
FALCON method \hl{cite} and other fitting methods like MoMA provide a
way to use high-throughput data to introduce many additional
constraints to the system.

Having a systems tool that can work with models of particular organisms
will not only add another tool in the computational evolution and
population genetics arsenal, but also in applied fields such as
evolutionary engineering of microbial engineering, and understanding
which gene mutant combinations which may be most advantageous for
a cancer cell population.

\section{Results}

\subsection{Weighted MoMA-FBA Objectives}

Minimization of metabolic adjustment (MoMA), along with Flux Balance
Analysis (FBA), has proven successful in simulating growth rates and
predicting in silico fluxes. Here we discuss a weighted objective
approach that combines both objectives. \hl{Insert some math background
from original \LaTeX~report.} 

The difference in smoothness between weighted quadratic MoMA and linear
MoMA can be illustrated by considering the growth rate to be a
function of the weight placed on the biomass objective (\Fig~\ref{fig:Fitness_LM_QP}).  An
advantage of quadratic MoMA is that it simulates a continuous range of
fitnesses, potentially matching any required fitness level exactly.
However, this is not necessarily always biologically relevant;
discrete mutations may give a discrete jump in fitness. Weighted
linear MoMA models these discrete transitions in flux state, and often
this is reflected in discrete jumps in fitness, as seen above.

\begin{figure}
\centering
  \includegraphics[width=\textwidth]{Fitness_LM_QP}
  \caption{\hl{it is empty}}
  \label{fig:Fitness_LM_QP}
\end{figure}

In the above figure, the difference in fitness between weighted
quadratic MoMA and linear MoMA can be seen. An advantage of quadratic
MoMA is that it simulates a continuous range of fitnesses, potentially
matching any required fitness level exactly.  However, this is not
necessarily always biologically relevant; in reality, discrete mutations may give
a discrete jump in fitness. Weighted linear MoMA models these discrete
transitions in flux state, and often this is reflected in discrete
jumps in fitness, as seen above.

\subsubsection{Weighted MoMA predicts expression states}

Using tiling array data for s288c in YPD and YPE conditions from
\hl{Xu et al.}, we compare the number of genes expected to have a
greater than two-fold change in expression from YPD to YPE to the fluxes
mapped to genes also having greater than two-fold change in the same
environmental transition. The x-axis represents the weight on
growth. Scaled fitness (green) is shown for reference. The number of
genes having more than two-fold flux and expression change in the model and and
in the experiment are shown in blue. The red and red dotted lines
represent the random expectation and 95\% CI for expression agreement
for a random expression vector with the genes belonging to the model
and experimental dataset. The random expression vector has the same
number of two-fold up-regulated and two-fold down-regulated genes as the
real relative expression vector.

\begin{figure}
\centering
\begin{tabular}{c}
\begin{subfigure}[b]{\textwidth}
  \includegraphics[width=\textwidth]{randGene_noFit}
  \caption{Linear MoMA} 
  \label{fig:randGene_noFit}
\end{subfigure}
\\
\begin{subfigure}[b]{\textwidth}
  \includegraphics[width=\textwidth]{randGene_noFit_QP}
  \caption{Quadratic MoMA} 
  \label{fig:randGene_noFit_QP}
\end{subfigure}
\\
\end{tabular}
\caption{\hl{It is empty}} 
\label{fig:wMoMA_expMatch}
\end{figure}


Interestingly, the weight and corresponding fitness that agrees most
with the experimental predictions is sub-optimal in both the quadratic
and linear cases, suggesting that the s288c strain was not fully
adapted to the YPE environment when the expression was assayed.  To
compare directly with geometric FBA (a min-L1 norm solution), we found
that geometric FBA had 123 concurring genes whereas weighted linear
MoMA had 124; similarly, a min-L2 norm FBA solution in Ethanol had 162
agreeing solutions and weighted quadratic MoMA had 165, showing that
weighted MoMA can do at least as good as the gold standards for de
novo FBA solutions in predicting accurate fluxes.


\subsubsection{Simulated adaptation induces complexity in sub-optimal solutions}

Previous work by \hl{Nishikawa et al.} explored the complexity of optimal
and sub-optimal flux vectors, finding that generally the sub-optimal
solutions have more active fluxes than the optimal solutions. We found
a similar trend where, once growth is non-zero, the initial flux state
has more active reactions than in the ancestral environment (glucose;
red dashed line) or than in the more adapted stages in the current
(ethanol) environment.


\begin{figure}
\centering
  \includegraphics[width=\textwidth]{complexityEth}
  \caption{\hl{it is empty}} 
  \label{fig:complexityEth}
\end{figure}


\subsection{Adaptive mutations with objective weights}

Aside from the problem of separating the fitness function from the 
optimization objective function, there is the issue of combining traditional flux
restriction mutations, which are known as \emph{hard constraints}, which may
result in an unsolvable system --- an almost certainly undesirable
effect of this mutation modeling formalism. Instead, it would be
better if mutations could be modeled as \emph{soft
  constraints}. Concretely, whereas hard constraints are enacted in
the actual constraints of the optimization problem, soft constraints
merely change the objective. This means that multiple soft constaints
combined together under some mutational model would be compatible in
the sense that they wouldn't unexpectedly result in an unsolvable
system. FALCON provides two possible avenues for soft constraints:
expression level and expression variation. \emph{However, it is not
  clear yet what expression variation really means, so further
  investigation is necessary.}


Perturbations other than flux constraint are possible. One problem
with flux constraint occurs when we select two different reactions
that are to have their flux increased. It is all too easy for these
perturbations to be viable and even beneficial under weighted MoMA,
but for the corresponding double mutant to be inviable. This is true
for even small increases in flux, however one defines small, due to
the rigidity of flux constraint. For instance, if we only have a
specific amount of subtrate to work with, and a particular pathway is
already operating at optimal capacity, raising the lower bound to a
value greater than that capacity will result in zero fitness, which is
certainly not the intent of what we wish to capture nor is it
physically realistic. An alternative that can address this issue is to
perturb the linear objective vector. When performing growth
optimization in FBA, normally only the biomass pseudo-reaction has a
non-zero (positive) entry. Nonzero values for any other entry could
only decrease the flux. In weighted MoMA nonzero values could prove
potentially beneficial, as they may push the system in a direction
that is more in line with growth optimization and less in line with
MoMA.

An example for both the quadratic and linear cases exemplifies the
difference in smoothness obtained from using either a linear or
quadratic objective for weighted MoMA with objective weights (mutations)
on a particular reaction (\Fig~\ref{fig:wMoMA_smoothness}).


\subsection{Adaptive trajectories and evolutionary path analysis}

Phenotypes involving a small number of mutations have had their
adaptive paths analyzed systematically (e.g. Weinreich 2007: five
mutations). In the case of Weinreich, all mutations occur on a single
enzyme, and even in such a localized case, sign epistasis, which gives
rise to evolutionary traps, occurs for the majority of mutational
paths.

In a genome-scale metabolic model, we observe that while the majority
of paths are not likely to have a problem, once eight or nine genes are
involved, the average number of paths to reach the optimum without
experiencing a trap are only ~65\%. This demonstrates that the
presence of traps are heterogeneous, just as in the single-enzyme
experiment of Weinreich (see ref below), suggesting that the order of
mutations often matter to a very significant degree in evolution.

The fact that more unobstructed evolutionary paths are observed as we
approach the genome-scale suggests that evolution is, in general, not
very predictable as the scale of the system increases, whereas for a
single-enzyme analysis as in the Weinreich study, it may be be
(however, need to compare to other similar studies).

\hl{include 2 subfigures}

\subsubsection{Software for evolutionary path analysis}

Storing all evolutionary paths in memory or disk can become 
intractable. For instance, even 10 mutations has $10! \approx
3.6$ million possible paths, but only $2^{10} = 1,024$ mutant
combinations. Due to this difficulty, we have created software to allow 
the dynamic exploration and analyses of these paths. 

The C programs for dynnamically performing analyses on text files
containing fitness data for all combinations of $n$ mutations
can be found at \url{https://github.com/bbarker/COBRAscripts}
in the \texttt{MyProjects/AdaptiveMuts/TreeTraversal} subdirectory.
\hl{Some of the features include (backtracking?, etc)}.  An example of
some of the files and use cases are described \hl{cite appendix
section}.

Notes: See Weinreich 2007 for really nice discussion and refs:
%http://webpub.brown.edu/Research/Weinreich/WeinreichPublications/Poelwijk_etal2007.pdf
%http://onlinelibrary.wiley.com/doi/10.1111/j.0014-3820.2005.tb01768.x/pdf

Note: also discuss the trends found for sign epistasis, if any, in the two recent science papers:
Khan et al.
Chou et al.

\section{Discussion}

The questions are often
difficult or impossible to assess experimentally due to limited
resources.  In genome-scale models, to our knowledge, only microbial
epistasis has so far been studied for all enzymes (often referred to
as genome-scale in this context). This is due to several factors.

One issue is that these computations can still take a significant
amount of time, and the increase in model size of Human Recon 2 over
Yeast can cause even a relatively simple FBA run to go up by an order
of magnitude.  This problem is compounded by the increase in the
number of genes in the human model, since computing epistasis consumes
space and time as $O(n^2)$ where $n$ is the number of genes in the
model. More important than this issue, which might be overcome with
enough computational resources, is the issue of an objective
function. It has been shown numerous times that FBA with a biomass
objective can be a reasonable approximation to what a microbe is
trying to achieve metabolically
\citep{Schuetz2012, Fong2004, Varma1994}. While Recon 2
is equipped with a ``generalized biomass reaction'', it is not clear
what the meaning of this is, and it certainly seems unlikely to
estimate the metabolism even of fast-growing cancer cells \hl{(cite
  Locasale?)}. We propose FALCON as a method to get around this issue
for non-microbial models.

Another advantage of FALCON is that it allows one to directly probe
mutations that are represented as gene expresion perturbations. A
decreased level of gene expression may also be metabolically
equivalent to the effect of a missense mutation, for example. This
allows a different sampling strategy than before; for instance, we
could observe how uniform expression restriction compares to uniform
flux restriction~\citep{Xu2012}. Assuming an accurate model of
enzyme-complex expression measurement, the former should be the more
realistic model.

A limitation is that we have only considered metabolic genes and their
effect on steady-state metabolism. While in principle a similar method
could be applied to whole cell models \hl{cite myco and e.coli}, the
computation time would not be feasible to the screening for beneficial
muatations, nor of exploring them combinatorally, as the time needed
for a single mutant takes at least a day even in the smallest
bacterial model \hl{cite}. Future isnights into improving the
efficiency of whole cell models, or making a compromise on which
systems are simulated, may improve these efforts.

\section{Methods}
\hl{it is empty}

\section{TODO}

\hl{need more background}


\hl{include weighted moma subsection to introduce need for FBA
in conjunction with FALCON; tie in this multiobjective function
to the multiobjective optimality found by Shuetz}

\hl{add images of Lin's experimental data}

\hl{actually try to use FALCON for GxG interactions, discuss caveat
that it is possible that influencing one enzymatic gene's abundance
could affect another enzymatic gene's abundance, and we can't directly
take this into account in our model}

\hl{discuss C software I developed for analysing adaptive trajectories;
need to update to work with FALCON}


\hl{briefly discuss FBA weight possibility}


\hl{Since beneficial mutations are relatively rare, and since
combining multiple mutants in the lab is increasingly difficult for
the more mutations that are to be combined, an \textit{in silico}
analysis can shed light on what may be expected in adaptive
evolution.}

